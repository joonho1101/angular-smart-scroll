/*! angular-smart-scroll - v0.0.7 - 2014-08-03 */
angular.module("jun.smartScroll",[]).directive("smartScroll",["$window","$timeout",function(a,b){"use strict";function c(a){if(a.style){var b=z(a);return d(b.css("overflow"))||d(b.css("overflow-x"))||d(b.css("overflow-y"))}return!1}function d(a){return"scroll"===a||"auto"===a}function e(a,b){for(;a;){if(b(a))return a;a=a.parentNode}return null}function f(a,b){return a?"number"==typeof a?a:"%"===a.charAt(a.length-1)?parseInt(a,10)/100*b:parseInt(a,10):0}function g(a,b){return f(a,b)+A}function h(a,b){return null!=b&&b>a}function i(a){var b=a.viewport,c=b.scrollTop(),d=a.remainingTop;a.remainingTop=c;var e=!!a.atTop,f=a.atTop=!c;if(e!==f&&a.onAtTop&&a.onAtTop(f),a.onScrollTop&&h(c,d)){var i=t(a,"distanceTop");(null==i||c<=g(i,b.innerHeight()))&&a.onScrollTop()}}function j(a){var b=a.viewport,c=b.scrollLeft(),d=a.remainingLeft;a.remainingLeft=c;var e=!!a.atLeft,f=a.atLeft=!c;if(e!==f&&a.onAtLeft&&a.onAtLeft(f),a.onScrollLeft&&h(c,d)){var i=t(a,"distanceLeft");(null==i||c<=g(i,b.innerWidth()))&&a.onScrollLeft()}}function k(a,b,c){return c-(a+b)}function l(a){return a.html||(a.html=z("html")[0])}function m(a){return a.body||(a.body=z("body")[0])}function n(b,c){return b===a?l(c).scrollWidth||m(c).scrollWidth:b.scrollWidth}function o(b,c){return b===a?l(c).scrollHeight||m(c).scrollHeight:b.scrollHeight}function p(a){a=a||this;var b=a.viewport,c=b.scrollTop(),d=b.innerHeight(),e=o(b[0],a),f=k(c,d,e);return{scrollPos:c,viewportLength:d,scrollLength:e,remaining:f}}function q(a){var b=p(a),c=b.remaining,d=a.remainingBottom;a.bottomStats=b,a.remainingBottom=c;var e=!!a.atBottom,f=a.atBottom=!c;if(e!==f&&a.onAtBottom&&a.onAtBottom(f),a.onScrollBottom&&h(c,d)){var i=t(a,"distanceBottom");(null==i||c<=g(i,b.viewportLength))&&a.onScrollBottom()}}function r(a){a=a||this;var b=a.viewport,c=b.scrollLeft(),d=b.innerWidth(),e=n(b[0],a),f=k(c,d,e);return{scrollPos:c,viewportLength:d,scrollLength:e,remaining:f}}function s(a){var b=r(a),c=b.remaining,d=a.remainingRight;a.rightStats=b,a.remainingRight=c;var e=!!a.atRight,f=a.atRight=!c;if(e!==f&&a.onAtRight&&a.onAtRight(f),a.onScrollRight&&h(c,d)){var i=t(a,"distanceRight");(null==i||c<=g(i,b.viewportLength))&&a.onScrollRight()}}function t(a,b){var c=a[b];return"function"==typeof c?a[b]():c}function u(a){return function(){t(a,"disabled")||(t(a,"disabledTop")||i(a),t(a,"disabledBottom")||q(a),t(a,"disabledLeft")||j(a),t(a,"disabledRight")||s(a),a.onScroll&&a.onScroll())}}function v(b,d){var f=b.viewport||e(d[0],c)||a;return"function"!=typeof f.on&&(f=z(f)),f}function w(a){for(;a;){if(a.smartScroll)return a.smartScroll;a=a.$parent}}function x(){var a=p(this);return a.scrollLength>a.viewportLength}function y(){var a=r(this);return a.scrollLength>a.viewportLength}var z=angular.element,A=.9;return{link:function(a,c){var d=w(a)||{},e=d.viewport=v(d,c),f=u(d);d.getScrollRightStats=r,d.getScrollBottomStats=p,d.hasVerticalScroll=x,d.hasHorizontalScroll=y,e.on("scroll",f),e.on("resize",f),a.$on("$destroy",function(){e.off("scroll",f),e.off("resize",f)}),b(f)}}}]);