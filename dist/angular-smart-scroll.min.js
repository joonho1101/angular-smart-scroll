/*! angular-smart-scroll - v0.0.3 - 2014-07-08 */
angular.module("jun.smartScroll",[]).directive("smartScroll",["$window","$timeout",function(a,b){"use strict";function c(a){if(a.style){var b=v(a);return d(b.css("overflow"))||d(b.css("overflow-x"))||d(b.css("overflow-y"))}return!1}function d(a){return"scroll"===a||"auto"===a}function e(a,b){for(;a;){if(b(a))return a;a=a.parentNode}return null}function f(a,b){return a?"number"==typeof a?a:"%"===a.charAt(a.length-1)?parseInt(a,10)/100*b:parseInt(a,10):0}function g(a,b){return f(a,b)+w}function h(a,b){return null!=b&&b>a}function i(a){var b=a.viewport,c=b.scrollTop(),d=a.remainingTop;if(a.remainingTop=c,h(c,d)){var e=r(a,"distanceTop");if(null==e)return a.onScrollTop();var f=b.innerHeight();return c<=g(e,f)?a.onScrollTop():void 0}}function j(a){var b=a.viewport,c=b.scrollLeft(),d=a.remainingLeft;if(a.remainingLeft=c,h(c,d)){var e=r(a,"distanceLeft");if(null==e)return a.onScrollLeft();var f=b.innerWidth();c<=g(e,f)&&a.onScrollLeft()}}function k(a,b,c){return c-(a+b)}function l(a){return a.html||(a.html=v("html")[0])}function m(a){return a.body||(a.body=v("body")[0])}function n(b,c){return b===a?l(c).scrollWidth||m(c).scrollWidth:b.scrollWidth}function o(b,c){return b===a?l(c).scrollHeight||m(c).scrollHeight:b.scrollHeight}function p(a){var b=a.viewport,c=b.scrollTop(),d=b.innerHeight(),e=o(b[0],a),f=k(c,d,e),i=a.remainingBottom;if(a.remainingBottom=f,h(f,i)){var j=r(a,"distanceBottom");return null==j?a.onScrollBottom():f<=g(j,d)?a.onScrollBottom():void 0}}function q(a){var b=a.viewport,c=b.scrollLeft(),d=b.innerWidth(),e=n(b[0],a),f=k(c,d,e),i=a.remainingRight;if(a.remainingRight=f,h(f,i)){var j=r(a,"distanceRight");return null==j?a.onScrollRight():f<=g(j,d)?a.onScrollRight():void 0}}function r(a,b){var c=a[b];return"function"==typeof c?a[b]():c}function s(a){return function(){r(a,"disabled")||(!r(a,"disabledTop")&&a.onScrollTop&&i(a),!r(a,"disabledBottom")&&a.onScrollBottom&&p(a),!r(a,"disabledLeft")&&a.onScrollLeft&&j(a),!r(a,"disabledRight")&&a.onScrollRight&&q(a),a.onScroll&&a.onScroll())}}function t(b,d){var f=b.viewport||e(d[0],c)||a;return"function"!=typeof f.on&&(f=v(f)),f}function u(a){for(;a;){if(a.smartScroll)return a.smartScroll;a=a.$parent}}var v=angular.element,w=.9;return{link:function(a,c){var d=u(a)||{},e=d.viewport=t(d,c),f=s(d);e.on("scroll",f),e.on("resize",f),a.$on("$destroy",function(){e.off("scroll",f),e.off("resize",f)}),b(f)}}}]);